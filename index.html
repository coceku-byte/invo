<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Invoice Mahesa VW Borobudur</title>

<style>
:root{
--bg:#f2f4f8;
--head:#2f2f2f;
--orange:#f59e0b;
--line:#d1d5db;
}

body{
margin:0;
padding:16px;
font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;
background:var(--bg);
}

.card{
max-width:900px;
margin:auto;
background:#fff;
border-radius:14px;
box-shadow:0 10px 30px rgba(0,0,0,.1);
overflow:hidden;
}

/* FORM */
#formArea{padding:16px}
label{display:block;margin-top:14px;font-weight:800}
input,select,textarea{
width:100%;
margin-top:6px;
padding:12px;
border:1px solid var(--line);
border-radius:10px;
font-size:15px;
}
textarea{min-height:80px}

.btn{
margin-top:14px;
padding:14px;
border:0;
border-radius:12px;
font-weight:900;
cursor:pointer;
}
.btnPrimary{
background:linear-gradient(90deg,#22c55e,#2563eb);
color:#fff;
}

/* PRINT AREA */
#printArea{display:none}

@media print{
body{padding:0;background:#fff}
#formArea{display:none}
#printArea{display:block}
.card{box-shadow:none;border-radius:0}
}

/* HEADER */
.invHeader{
background:var(--head);
color:#fff;
padding:16px;
display:flex;
align-items:center;
gap:14px;
}
.logo{
width:60px;
height:60px;
border-radius:999px;
overflow:hidden;
background:#000;
}
.logo img{width:100%;height:100%;object-fit:cover}

.invTitle{
flex:1;
}
.invTitle h1{
margin:0;
color:var(--orange);
font-size:22px;
letter-spacing:.5px;
}
.invTitle p{
margin:4px 0 0;
font-size:12px;
color:#ddd;
line-height:1.4;
}

/* TABLE */
.table{
width:100%;
border-collapse:collapse;
margin-top:14px;
font-size:13px;
}
.table th{
background:var(--orange);
border:2px solid #d97706;
padding:10px;
}
.table td{
border:2px solid var(--line);
padding:10px;
}
.table td.num{text-align:right}
.table td.center{text-align:center}

.totals{
width:420px;
margin-left:auto;
margin-top:10px;
border-collapse:collapse;
}
.totals td{
border:2px solid var(--line);
padding:10px;
font-weight:800;
}
.totals .kek td{
background:#fff7cc;
font-size:14px;
}

/* STAMP */
.stamp{
position:relative;
height:0;
}
.stamp span{
position:absolute;
right:50px;
top:-30px;
transform:rotate(-12deg);
font-weight:900;
font-size:46px;
color:#ef4444;
opacity:.35;
border:6px solid #ef4444;
padding:8px 16px;
border-radius:8px;
display:none;
}
.stamp .show{display:block}
</style>
</head>

<body>
<div class="card">

<!-- ================= FORM ================= -->
<div id="formArea">
<h2>Invoice Generator</h2>

<label>Upload Logo</label>
<input type="file" id="logoInput" accept="image/*">

<label>Nama Customer</label>
<input id="custName">

<label>No HP</label>
<input id="custHp">

<label>Pilih Paket VW</label>
<select id="paket">
<option value="350000|Paket Short VW Borobudur">Paket Short (2 Jam)</option>
<option value="550000|Paket Medium VW Borobudur">Paket Medium (3 Jam)</option>
<option value="700000|Paket Long VW Borobudur">Paket Long (4 Jam)</option>
<option value="0|Custom">Custom</option>
</select>

<label>Jumlah</label>
<input type="number" id="qty" value="1">

<label>Harga</label>
<input type="number" id="price" value="350000">

<label>DP</label>
<input type="number" id="dp" value="0">

<label>Status Stamp</label>
<select id="stampMode">
<option value="none">Tanpa Tampilan</option>
<option value="lunas">LUNAS</option>
<option value="belum">BELUM LUNAS</option>
<option value="dp">DP</option>
</select>

<button class="btn btnPrimary" onclick="generate()">Generate PDF</button>
</div>

<!-- ================= PRINT ================= -->
<div id="printArea">

<div class="invHeader">
<div class="logo"><img id="pLogo"></div>
<div class="invTitle">
<h1>MAHESA VW BOROBUDUR</h1>
<p>Jl. Medang Kamulan, Borobudur, Magelang<br>
Telp: 0823-5505-7022</p>
</div>
</div>

<div style="padding:18px">
<div><b>FAKTUR #:</b> <span id="pInv"></span></div>
<div><b>Tanggal:</b> <span id="pDate"></span></div>
<div><b>Nama:</b> <span id="pCust"></span></div>
<div><b>No HP:</b> <span id="pHp"></span></div>

<div class="stamp">
<span id="stampLunas">LUNAS</span>
<span id="stampBelum">BELUM</span>
<span id="stampDP">DP</span>
</div>

<table class="table">
<thead>
<tr>
<th>Paket</th>
<th>Jumlah</th>
<th>Harga</th>
<th>Total</th>
</tr>
</thead>
<tbody id="rows"></tbody>
</table>

<table class="totals">
<tr><td>Subtotal</td><td id="pSub" class="num"></td></tr>
<tr><td>DP</td><td id="pDP" class="num"></td></tr>
<tr class="kek"><td>Kekurangan</td><td id="pBal" class="num"></td></tr>
</table>

<div style="margin-top:16px;font-size:13px">
Pembayaran ke Bank Mandiri<br>
Atas Nama: Dani Ariwibowo<br>
Rekening: 136-001-339-280-5
</div>
</div>

</div>
</div>

<script>
const rupiah=n=>"Rp "+Number(n).toLocaleString("id-ID");
const KEY="inv_no_v1";
const START=32244;

function nextNo(){
let v=localStorage.getItem(KEY);
let next=v?Number(v)+1:START;
localStorage.setItem(KEY,next);
return next;
}

document.getElementById("logoInput").addEventListener("change",e=>{
const f=e.target.files[0];
const r=new FileReader();
r.onload=ev=>localStorage.setItem("logo_data",ev.target.result);
r.readAsDataURL(f);
});

function generate(){
const no=nextNo();
document.getElementById("pInv").textContent=no;
document.getElementById("pDate").textContent=new Date().toLocaleDateString("id-ID");
document.getElementById("pCust").textContent=document.getElementById("custName").value;
document.getElementById("pHp").textContent=document.getElementById("custHp").value;

const [price,name]=document.getElementById("paket").value.split("|");
const qty=Number(document.getElementById("qty").value);
const pr=Number(document.getElementById("price").value||price);
const total=qty*pr;

document.getElementById("rows").innerHTML=
`<tr>
<td>${name}</td>
<td class="center">${qty}</td>
<td class="num">${rupiah(pr)}</td>
<td class="num">${rupiah(total)}</td>
</tr>`;

const dp=Number(document.getElementById("dp").value);
document.getElementById("pSub").textContent=rupiah(total);
document.getElementById("pDP").textContent="-"+rupiah(dp);
document.getElementById("pBal").textContent=rupiah(Math.max(total-dp,0));

document.getElementById("stampLunas").classList.remove("show");
document.getElementById("stampBelum").classList.remove("show");
document.getElementById("stampDP").classList.remove("show");

const mode=document.getElementById("stampMode").value;
if(mode==="lunas")document.getElementById("stampLunas").classList.add("show");
if(mode==="belum")document.getElementById("stampBelum").classList.add("show");
if(mode==="dp")document.getElementById("stampDP").classList.add("show");

const logo=localStorage.getItem("logo_data");
if(logo)document.getElementById("pLogo").src=logo;

window.print();
}
</script>

</body>
</html>