<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Invoice Mahesa VW</title>

<style>
body{font-family:Arial;background:#f3f4f6;padding:20px}
.container{max-width:900px;margin:auto;background:#fff;padding:30px;box-shadow:0 15px 40px rgba(0,0,0,.08)}
.header{display:flex;gap:15px;align-items:center;border-bottom:3px solid #f59e0b;padding-bottom:10px}
.header img{width:70px}
.header h1{margin:0;color:#f59e0b}
.header p{margin:2px 0 0 0;font-size:13px;font-weight:600;color:#111}

input,select{width:100%;padding:8px;margin-bottom:10px;border:1px solid #ccc;border-radius:6px}
button{background:#f59e0b;border:none;padding:10px 15px;color:white;font-weight:bold;border-radius:6px;cursor:pointer}
button:hover{opacity:.9}

table{width:100%;border-collapse:collapse;margin-top:15px}
th{background:#f59e0b;color:white;padding:8px}
td{border:1px solid #ccc;padding:8px}
.right{text-align:right;font-weight:bold}

.total-box{margin-left:58%;width:42%}

.status{
position:absolute;
right:50px;
top:140px;
font-size:48px;
font-weight:bold;
transform:rotate(-15deg);
opacity:0.18;
display:none
}
.lunas{color:green}
.belum{color:red}

@media print{
body{background:white}
.no-print{display:none}
}
</style>
</head>

<body>

<div class="container">

<div class="header">
<img id="logoPreview">
<div>
<h1>MAHESA VW BOROBUDUR</h1>
<p>Jl. Medang Kamulan, Borobudur, Magelang â€¢ WA: 0823-5505-7022</p>
</div>
</div>

<h3 class="no-print">Data Invoice</h3>

<input type="file" id="logoInput" class="no-print">

<label>Nama Customer</label>
<input type="text" id="nama">

<label>No HP</label>
<input type="text" id="hp">

<label>Tanggal Tour</label>
<input type="date" id="tanggal">

<label>Pilih Paket</label>
<select id="paket" onchange="syncPaket()">
<option value="400000|Paket Short (2 Jam)">Paket Short (2 Jam)</option>
<option value="550000|Paket Medium (3 Jam)">Paket Medium (3 Jam)</option>
<option value="700000|Paket Long (4 Jam)">Paket Long (4 Jam)</option>
<option value="0|Custom">Custom</option>
</select>

<label>Nama Paket</label>
<input type="text" id="paketNama">

<label>Jumlah</label>
<input type="number" id="qty" value="1">

<label>Harga</label>
<input type="number" id="harga">

<button onclick="addItem()" class="no-print">Tambah Item</button>

<table>
<thead>
<tr>
<th>Item</th>
<th>Qty</th>
<th>Harga</th>
<th>Total</th>
</tr>
</thead>
<tbody id="itemBody"></tbody>
</table>

<label>DP</label>
<input type="number" id="dp" value="0">

<label>Status</label>
<select id="status">
<option value="none">Tanpa Tampilan</option>
<option value="lunas">LUNAS</option>
<option value="belum">BELUM LUNAS</option>
</select>

<div class="total-box">
<table>
<tr><td class="right">Subtotal</td><td class="right" id="subtotal">0</td></tr>
<tr><td class="right">DP</td><td class="right" id="dpVal">0</td></tr>
<tr><td class="right">Kekurangan</td><td class="right" id="sisa">0</td></tr>
</table>
</div>

<div id="stamp" class="status">LUNAS</div>

<br>
<button onclick="generate()" class="no-print">Generate PDF</button>

</div>

<script>
let invoiceNo = localStorage.getItem("invoiceNo") || 32244;
localStorage.setItem("invoiceNo", parseInt(invoiceNo)+1);

function formatRp(n){
return "Rp " + Number(n).toLocaleString("id-ID");
}

function syncPaket(){
let val=document.getElementById("paket").value.split("|");
document.getElementById("paketNama").value=val[1];
document.getElementById("harga").value=val[0];
}

function addItem(){
let name=document.getElementById("paketNama").value;
let qty=parseInt(document.getElementById("qty").value);
let price=parseInt(document.getElementById("harga").value);

if(!name||!qty||!price) return;

let total=qty*price;

let row=`<tr>
<td>${name}</td>
<td>${qty}</td>
<td>${formatRp(price)}</td>
<td>${formatRp(total)}</td>
</tr>`;

document.getElementById("itemBody").innerHTML+=row;
calculate();
}

function calculate(){
let rows=document.querySelectorAll("#itemBody tr");
let subtotal=0;
rows.forEach(r=>{
let val=r.children[3].innerText.replace(/[^0-9]/g,'');
subtotal+=parseInt(val);
});
let dp=parseInt(document.getElementById("dp").value)||0;
let sisa=subtotal-dp;

document.getElementById("subtotal").innerText=formatRp(subtotal);
document.getElementById("dpVal").innerText="- "+formatRp(dp);
document.getElementById("sisa").innerText=formatRp(sisa);

let status=document.getElementById("status").value;
let stamp=document.getElementById("stamp");

if(status==="lunas"){
stamp.style.display="block";
stamp.className="status lunas";
stamp.innerText="LUNAS";
}
else if(status==="belum"){
stamp.style.display="block";
stamp.className="status belum";
stamp.innerText="BELUM LUNAS";
}
else{
stamp.style.display="none";
}
}

document.getElementById("dp").addEventListener("input",calculate);
document.getElementById("status").addEventListener("change",calculate);

function generate(){
calculate();

let nama=document.getElementById("nama").value||"Invoice";
let clean=nama.replace(/[^a-zA-Z0-9]/g,"-");
document.title=clean+"_"+invoiceNo;

window.print();
}

document.getElementById("logoInput").addEventListener("change",function(e){
const reader=new FileReader();
reader.onload=function(){
document.getElementById("logoPreview").src=reader.result;
}
reader.readAsDataURL(e.target.files[0]);
});
</script>

</body>
</html>