<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Invoice Mahesa VW</title>

<style>
body{
  font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;
  background:#f3f4f6;
  margin:0;
  padding:20px;
}

.card{
  background:#fff;
  max-width:900px;
  margin:auto;
  padding:25px;
  border-radius:16px;
  box-shadow:0 10px 30px rgba(0,0,0,.08);
}

h2{margin-top:0}

input, select{
  width:100%;
  padding:10px;
  border-radius:8px;
  border:1px solid #ddd;
  margin-top:5px;
  margin-bottom:15px;
  font-size:14px;
}

button{
  background:linear-gradient(135deg,#16a34a,#2563eb);
  border:none;
  padding:12px 20px;
  color:#fff;
  font-weight:700;
  border-radius:10px;
  cursor:pointer;
}

button:hover{opacity:.9}

.tableInput{
  width:100%;
  border-collapse:collapse;
}

.tableInput th,
.tableInput td{
  border:1px solid #ddd;
  padding:8px;
}

.tableInput th{
  background:#f59e0b;
  color:#000;
  font-weight:900;
}

.addItem{
  background:#111827;
  margin-bottom:15px;
}

/* PRINT */

@media print{
  body{background:#fff}
  .card{box-shadow:none}
  #formArea{display:none}
}

.invHeader{
  background:#111827;
  color:#fff;
  padding:15px;
  border-radius:12px;
  display:flex;
  align-items:center;
  gap:15px;
}

.logo{
  width:70px;
  height:70px;
  border-radius:12px;
  object-fit:cover;
}

.brand{
  font-size:20px;
  font-weight:900;
  color:#f59e0b;
}

.address{
  font-size:13px;
  font-weight:800;
  color:#fff;
  margin-top:5px;
}

.invTable{
  width:100%;
  border-collapse:collapse;
  margin-top:20px;
}

.invTable th{
  background:#f59e0b;
  border:2px solid #d97706;
  padding:10px;
}

.invTable td{
  border:2px solid #ddd;
  padding:10px;
}

.totals{
  width:350px;
  margin-left:auto;
  margin-top:10px;
  border-collapse:collapse;
}

.totals td{
  border:2px solid #ddd;
  padding:10px;
  font-weight:900;
}

.kek{
  background:#fff7cc;
}

.stamp{
  font-size:40px;
  font-weight:900;
  opacity:.25;
  transform:rotate(-15deg);
  position:absolute;
  right:40px;
  top:150px;
  display:none;
}

.lunas{color:green}
.belum{color:red}

</style>
</head>
<body>

<div class="card" id="formArea">

<h2>Generate Invoice</h2>

<label>Logo</label>
<input type="file" id="logoInput">

<label>Nomor Faktur</label>
<input type="text" id="inv">

<label>Tanggal Tour</label>
<input type="date" id="tanggal">

<label>Nama Customer</label>
<input type="text" id="nama">

<label>No HP</label>
<input type="text" id="hp">

<table class="tableInput">
<thead>
<tr>
<th>Item</th>
<th>Qty</th>
<th>Harga</th>
<th>Total</th>
</tr>
</thead>
<tbody id="items">
<tr>
<td><input></td>
<td><input type="number" value="1"></td>
<td><input type="number"></td>
<td class="totalCell">0</td>
</tr>
</tbody>
</table>

<button class="addItem" onclick="addRow()">+ Tambah Item</button>

<label>DP</label>
<input type="number" id="dp" value="0">

<label>Status Stamp</label>
<select id="status">
<option value="none">Tanpa Tampilan</option>
<option value="lunas">LUNAS</option>
<option value="belum">BELUM LUNAS</option>
</select>

<br><br>
<button onclick="generate()">Generate & Print</button>

</div>

<div id="printArea" style="display:none; position:relative;">

<div class="invHeader">
<img id="pLogo" class="logo">
<div>
<div class="brand">MAHESA VW BOROBUDUR</div>
<div class="address">
Jl. Medang Kamulan, Dusun XIII, Borobudur, Magelang, Jawa Tengah â€¢ WA: 0823-5505-7022
</div>
</div>
</div>

<br>

<b>FAKTUR #:</b> <span id="pInv"></span><br>
<b>Tanggal:</b> <span id="pTanggal"></span><br>
<b>Nama:</b> <span id="pNama"></span><br>
<b>No HP:</b> <span id="pHp"></span><br>

<div class="stamp lunas" id="stampLunas">LUNAS</div>
<div class="stamp belum" id="stampBelum">BELUM</div>

<table class="invTable">
<thead>
<tr>
<th>Item</th>
<th>Qty</th>
<th>Harga</th>
<th>Total</th>
</tr>
</thead>
<tbody id="pItems"></tbody>
</table>

<table class="totals">
<tr><td>Subtotal</td><td id="pSub"></td></tr>
<tr><td>DP</td><td id="pDP"></td></tr>
<tr class="kek"><td>Kekurangan</td><td id="pSisa"></td></tr>
</table>

</div>

<script>

function addRow(){
let row = `
<tr>
<td><input></td>
<td><input type="number" value="1"></td>
<td><input type="number"></td>
<td class="totalCell">0</td>
</tr>`;
document.getElementById("items").insertAdjacentHTML("beforeend", row);
}

function formatRupiah(n){
return "Rp " + n.toLocaleString("id-ID");
}

function generate(){

let subtotal = 0;
let rows = document.querySelectorAll("#items tr");
let output = "";

rows.forEach(r=>{
let item = r.children[0].querySelector("input").value;
let qty = Number(r.children[1].querySelector("input").value);
let harga = Number(r.children[2].querySelector("input").value);
let total = qty * harga;
subtotal += total;

output += `<tr>
<td>${item}</td>
<td>${qty}</td>
<td>${formatRupiah(harga)}</td>
<td>${formatRupiah(total)}</td>
</tr>`;
});

let dp = Number(document.getElementById("dp").value);
let sisa = subtotal - dp;

document.getElementById("pItems").innerHTML = output;
document.getElementById("pSub").innerText = formatRupiah(subtotal);
document.getElementById("pDP").innerText = "- " + formatRupiah(dp);
document.getElementById("pSisa").innerText = formatRupiah(sisa);

document.getElementById("pInv").innerText = document.getElementById("inv").value;
document.getElementById("pTanggal").innerText = document.getElementById("tanggal").value;
document.getElementById("pNama").innerText = document.getElementById("nama").value;
document.getElementById("pHp").innerText = document.getElementById("hp").value;

let status = document.getElementById("status").value;
document.getElementById("stampLunas").style.display = "none";
document.getElementById("stampBelum").style.display = "none";

if(status === "lunas"){
document.getElementById("stampLunas").style.display = "block";
}
if(status === "belum"){
document.getElementById("stampBelum").style.display = "block";
}

let file = document.getElementById("logoInput").files[0];
if(file){
let reader = new FileReader();
reader.onload = function(e){
document.getElementById("pLogo").src = e.target.result;
};
reader.readAsDataURL(file);
}

document.getElementById("formArea").style.display="none";
document.getElementById("printArea").style.display="block";

window.print();
}

</script>

</body>
</html>